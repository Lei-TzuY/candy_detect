# Web æ‡‰ç”¨è¨­ç½®æŒ‡å—

## âœ… å®‰è£ç‹€æ…‹

æ‰€æœ‰ä¾è³´å·²æˆåŠŸå®‰è£ï¼š
- âœ… Flask (Web æ¡†æ¶)
- âœ… Flask-CORS (è·¨åŸŸæ”¯æŒ)
- âœ… OpenCV (å½±åƒè™•ç†)
- âœ… NumPy (æ•¸å€¼è¨ˆç®—)
- âœ… Requests (HTTP è«‹æ±‚)

## ğŸš€ å¿«é€Ÿå•Ÿå‹•

### æ–¹æ³• 1ï¼šç›´æ¥é‹è¡Œï¼ˆæ¨è–¦ï¼‰

```powershell
cd c:\Users\st313\Desktop\candy
.venv\Scripts\python.exe web_app.py
```

Web æ‡‰ç”¨å°‡åœ¨ä»¥ä¸‹åœ°å€å•Ÿå‹•ï¼š
- **æœ¬åœ°è¨ªå•**: http://localhost:5000
- **ç¶²çµ¡è¨ªå•**: http://<æ‚¨çš„IP>:5000

### æ–¹æ³• 2ï¼šä½¿ç”¨æ‰¹è™•ç†æ–‡ä»¶

å»ºç«‹ `start_web_app.bat` æ–‡ä»¶ï¼š

```batch
@echo off
cd /d C:\Users\st313\Desktop\candy
.venv\Scripts\python.exe web_app.py
pause
```

ç„¶å¾Œé›™æ“ŠåŸ·è¡Œè©²æ–‡ä»¶ã€‚

### æ–¹æ³• 3ï¼šé–‹ç™¼æ¨¡å¼ï¼ˆèª¿è©¦ç”¨ï¼‰

```powershell
cd c:\Users\st313\Desktop\candy
$env:FLASK_APP="web_app.py"
$env:FLASK_ENV="development"
.venv\Scripts\flask run
```

## ğŸ“‹ ä¸»è¦åŠŸèƒ½

### 1. **å³æ™‚å½±åƒä¸²æµ**
   - æ”¯æŒå¤šæ”åƒé ­åŒæ™‚é¡¯ç¤º
   - å¯¦æ™‚æª¢æ¸¬çµæœç–ŠåŠ 

### 2. **æ•¸æ“šå„€è¡¨æ¿**
   - FPS ç›£æ¸¬
   - æª¢æ¸¬çµ±è¨ˆï¼ˆæ­£å¸¸/ç•°å¸¸æ¯”ä¾‹ï¼‰
   - å¯¦æ™‚æ€§èƒ½æŒ‡æ¨™

### 3. **æ­·å²æŸ¥è©¢**
   - æŸ¥çœ‹éå»æª¢æ¸¬è¨˜éŒ„
   - ç¼ºé™·åœ–åƒå­˜æª”
   - æ™‚é–“ç¯„åœç¯©é¸

## ğŸ”§ é…ç½®èª¿æ•´

### æ›´æ”¹ Flask é‹è¡Œåƒæ•¸

ç·¨è¼¯ `web_app.py` æœ€å¾Œå¹¾è¡Œï¼š

```python
if __name__ == "__main__":
    # èª¿æ•´ä»¥ä¸‹åƒæ•¸ï¼š
    app.run(
        host="0.0.0.0",      # 0.0.0.0 = å…è¨±å¤–éƒ¨è¨ªå•ï¼Œ127.0.0.1 = åƒ…æœ¬åœ°
        port=5000,            # æ”¹è®Šç«¯å£è™Ÿ
        debug=True,           # debug=False ç”¨æ–¼ç”Ÿç”¢ç’°å¢ƒ
        threaded=True         # å¤šç·šç¨‹æ”¯æŒ
    )
```

### ç›£è½ç¶²çµ¡é€£æ¥

å¦‚æœè¦å¾å…¶ä»–é›»è…¦è¨ªå•ï¼š

```python
app.run(host="0.0.0.0", port=5000, debug=False)
```

ç„¶å¾Œå¾å…¶ä»–é›»è…¦è¨ªå•ï¼š
```
http://<æ‚¨é›»è…¦çš„IPåœ°å€>:5000
```

æŸ¥çœ‹ IP åœ°å€ï¼š
```powershell
ipconfig
# æ‰¾ IPv4 Addressï¼Œä¾‹å¦‚ 192.168.x.x
```

## ğŸ“Š ç³»çµ±è¦æ±‚

- **Python**: 3.8+ (ç•¶å‰ä½¿ç”¨ 3.11.4)
- **æ“ä½œç³»çµ±**: Windows 10/11
- **å…§å­˜**: è‡³å°‘ 2GB
- **æ”åƒé ­**: 2 å€‹ï¼ˆCamera1ã€Camera2ï¼‰

## âš ï¸ å¸¸è¦‹å•é¡Œ

### å•é¡Œ 1ï¼šç«¯å£å·²è¢«å ç”¨

éŒ¯èª¤ä¿¡æ¯ï¼š
```
Address already in use
```

è§£æ±ºæ–¹æ¡ˆ - æ”¹è®Šç«¯å£è™Ÿï¼š
```python
app.run(host="0.0.0.0", port=5001)  # æ”¹ç‚º 5001
```

æˆ–çµ‚æ­¢å·²å ç”¨çš„é€²ç¨‹ï¼š
```powershell
Get-Process | Where-Object {$_.Port -eq 5000}
Stop-Process -Id <PID> -Force
```

### å•é¡Œ 2ï¼šç„¡æ³•è¨ªå• Web æ‡‰ç”¨

æª¢æŸ¥æ¸…å–®ï¼š
1. âœ“ Flask å·²å•Ÿå‹•ï¼ˆçœ‹åˆ° `Running on` æ¶ˆæ¯ï¼‰
2. âœ“ é˜²ç«ç‰†å…è¨±ç«¯å£ 5000
3. âœ“ ä½¿ç”¨æ­£ç¢ºçš„ IP åœ°å€ï¼ˆlocalhost æˆ– 127.0.0.1ï¼‰
4. âœ“ ç€è¦½å™¨å·²åˆ·æ–°é é¢ (Ctrl+F5)

### å•é¡Œ 3ï¼šæ”åƒé ­ç„¡æ³•é€£æ¥

æª¢æŸ¥ `config.ini`ï¼š
```ini
[Camera1]
enabled = 1
camera_id = 0

[Camera2]
enabled = 1
camera_id = 1
```

ç¢ºèªæ”åƒé ­è¨­å‚™è™Ÿï¼ˆ0, 1, 2...ï¼‰

### å•é¡Œ 4ï¼šæ€§èƒ½ä½ä¸‹

å„ªåŒ–å»ºè­°ï¼š
1. æ¸›å°‘å½±åƒè§£æåº¦ï¼ˆåœ¨ `config.ini` ä¸­è¨­ç½®ï¼‰
2. ç¦ç”¨æœªä½¿ç”¨çš„å„ªåŒ–ï¼ˆROIã€Kalman ç­‰ï¼‰
3. é—œé–‰èª¿è©¦æ¨¡å¼ (`debug=False`)
4. åœ¨å°ˆç”¨æ©Ÿå™¨ä¸Šé‹è¡Œ

## ğŸ”Œ API ç«¯é»

### ç²å–å³æ™‚çµ±è¨ˆä¿¡æ¯

```bash
curl http://localhost:5000/api/stats
```

å“æ‡‰ç¤ºä¾‹ï¼š
```json
{
  "timestamp": "2025-11-21T10:30:45",
  "cameras": {
    "Camera1": {
      "fps": 25,
      "total_detections": 1250,
      "abnormal_count": 45
    },
    "Camera2": {
      "fps": 24,
      "total_detections": 1180,
      "abnormal_count": 52
    }
  }
}
```

### ç²å–æ­·å²è¨˜éŒ„

```bash
curl "http://localhost:5000/api/history?camera=Camera1&days=7"
```

### å–å¾—ç¼ºé™·åœ–åƒåˆ—è¡¨

```bash
curl "http://localhost:5000/api/defect_images?camera=Camera1&limit=10"
```

## ğŸ“ˆ æ€§èƒ½ç›£æ¸¬

åœ¨ Web ç•Œé¢ä¸Šå¯ä»¥æŸ¥çœ‹ï¼š

| æŒ‡æ¨™ | èªªæ˜ | ç›®æ¨™å€¼ |
|------|------|-------|
| FPS | æ¯ç§’å¹€æ•¸ | 15-30 |
| æª¢æ¸¬å»¶é² | æ¯«ç§’ | < 100ms |
| å…§å­˜ä½¿ç”¨ | MB | < 500MB |
| CPU ä½¿ç”¨ç‡ | % | < 80% |

## ğŸ›‘ åœæ­¢ Web æ‡‰ç”¨

åœ¨çµ‚ç«¯æŒ‰ `Ctrl+C` åœæ­¢ã€‚

## ğŸ“ æ—¥èªŒæ–‡ä»¶

Web æ‡‰ç”¨æ—¥èªŒä½ç½®ï¼š
```
app/logs/app.log
```

æŸ¥çœ‹å¯¦æ™‚æ—¥èªŒï¼š
```powershell
Get-Content app/logs/app.log -Tail 50 -Wait
```

## ğŸ¯ ä¸‹ä¸€æ­¥

1. **å•Ÿå‹• Web æ‡‰ç”¨**
   ```powershell
   .venv\Scripts\python.exe web_app.py
   ```

2. **æ‰“é–‹ç€è¦½å™¨**
   è¨ªå• `http://localhost:5000`

3. **æª¢æŸ¥æ”åƒé ­ç‹€æ…‹**
   ç¢ºèªå…©å€‹æ”åƒé ­éƒ½å·²é€£æ¥ä¸¦å‡ºç¾åœ¨å„€è¡¨æ¿

4. **ç›£æ¸¬æ€§èƒ½**
   è§€å¯Ÿ FPSã€æª¢æ¸¬ç‡ã€ç•°å¸¸æ•¸é‡ç­‰æŒ‡æ¨™

5. **æ ¹æ“šéœ€è¦èª¿æ•´é…ç½®**
   ä½¿ç”¨ `config.ini` å’Œ Web ç•Œé¢èª¿æ•´åƒæ•¸

---

**å®‰è£æ—¥æœŸ**: 2025-11-21  
**Python ç‰ˆæœ¬**: 3.11.4  
**è™›æ“¬ç’°å¢ƒ**: `.venv`

å¦‚æœ‰å•é¡Œï¼Œè«‹æŸ¥çœ‹ `app/logs/app.log` ä¸­çš„éŒ¯èª¤æ—¥èªŒã€‚
