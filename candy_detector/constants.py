"""
常數和配置定義

常數定義區，集中管理項目中使用的所有常數，
便於維護和調整。
"""

import os

# ============================================================================
# 項目路徑配置
# ============================================================================
PROJECT_ROOT = os.path.dirname(os.path.dirname(os.path.abspath(__file__)))
CONFIG_FILE = os.path.join(PROJECT_ROOT, "config.ini")
LOGS_DIR = os.path.join(PROJECT_ROOT, "logs")
RESULTS_DIR = os.path.join(PROJECT_ROOT, "results")

# 確保日誌和結果目錄存在
os.makedirs(LOGS_DIR, exist_ok=True)
os.makedirs(RESULTS_DIR, exist_ok=True)

# ============================================================================
# 影像處理參數
# ============================================================================
DEFAULT_DISPLAY_HEIGHT = 480
AUTO_SCREEN_MARGIN = 80

# ============================================================================
# 偵測追蹤參數
# ============================================================================
TRACK_DISTANCE_THRESHOLD_PX = 150  # 物體距離閾值（像素）- 提高閾值減少重複追蹤
MAX_MISSED_FRAMES = 15  # 最大連續遺漏幀數

# ============================================================================
# YOLO 檢測參數
# ============================================================================
YOLO_DEFAULT_INPUT_SIZE = 416
YOLO_DEFAULT_CONF_THRESHOLD = 0.2
YOLO_DEFAULT_NMS_THRESHOLD = 0.4

# ============================================================================
# 相機參數
# ============================================================================
CAMERA_DEFAULT_WIDTH = 1920
CAMERA_DEFAULT_HEIGHT = 1080
CAMERA_BACKEND = "CAP_DSHOW"  # 使用 DirectShow 作為相機後端

# ============================================================================
# 繼電器配置
# ============================================================================
RELAY_MAX_DELAY_MS = 5000  # 最大繼電器延遲（毫秒）
RELAY_TIMEOUT_SECONDS = 2

# ============================================================================
# UI 配置
# ============================================================================
DISPLAY_FONT = "cv2.FONT_HERSHEY_SIMPLEX"
DISPLAY_FONT_SCALE = 1.0
DISPLAY_COLORS = {
    "normal": (0, 255, 0),  # 綠色 - 正常
    "abnormal": (0, 0, 255),  # 紅色 - 異常
    "detection_line": (200, 100, 0),  # 藍橙色 - 偵測線
    "tracking_box": (0, 0, 255),  # 紅色 - 追蹤框
    "text_normal": (0, 200, 0),  # 淺綠色 - 正常文字
    "text_abnormal": (0, 0, 200),  # 淺紅色 - 異常文字
    "text_white": (255, 255, 255),  # 白色 - 標題文字
}

# ============================================================================
# 類別標籤
# ============================================================================
CLASS_NORMAL = "normal"
CLASS_ABNORMAL = "abnormal"

# ============================================================================
# 日誌配置
# ============================================================================
LOG_FORMAT = "%(asctime)s - %(name)s - %(levelname)s - %(message)s"
LOG_DATE_FORMAT = "%Y-%m-%d %H:%M:%S"
LOG_LEVEL = "INFO"
