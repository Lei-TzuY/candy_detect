# 錄影編碼器選擇功能

## 功能描述

為了進一步解決錄影檔案在不同系統（特別是 Windows）上的播放相容性問題，我們在錄影頁面添加了一個「視頻編碼器」選擇下拉選單。這允許用戶根據自己的需求和系統環境，手動選擇錄影時使用的編碼器。

## 使用方法

1.  進入錄影頁面 (`/recorder`)。
2.  在頁面上方的全域控制區域，找到「📹 視頻編碼器」下拉選單。
3.  從以下選項中選擇一個編碼器：
    *   **XVID (預設)**：相容性極高，大多數播放器都支援。
    *   **H.264 (avc1)**：畫質最佳，壓縮率高，推薦用於現代播放器。
    *   **MJPG (Motion JPEG)**：通用性最強，幾乎所有系統都能播放，但檔案體積較大。
    *   **mp4v (MPEG-4)**：作為備用選項。
4.  點擊「開始錄影」按鈕（單一鏡頭或全部）。
5.  系統將嘗試使用您選擇的編碼器開始錄影。

## 技術細節

### 後端邏輯 (`src/video_recorder.py`)

*   `VideoRecorder.start_recording` 方法現在接受一個可選的 `codec` 參數。
*   如果提供了 `codec` 參數，系統會將該編碼器放入嘗試列表的最前方。
*   系統會依序嘗試列表中的編碼器，直到找到一個可用的為止。這意味著即使您選擇的編碼器在當前環境下不可用，系統也會自動回退到其他可用的編碼器，確保錄影不會失敗。

### API 變更 (`src/web_app.py`)

*   `POST /api/recorder/<camera_index>/start` 端點現在接受 JSON body 中的 `codec` 欄位。

### 前端變更 (`templates/recorder.html`)

*   新增了編碼器選擇下拉選單。
*   JavaScript 的 `toggleRecording` 函數已更新，在發送開始錄影請求時會包含選定的編碼器。

## 故障排除

*   **錄影失敗**：如果所有編碼器都無法使用，請檢查是否已安裝 OpenCV 和相應的編解碼器包。
*   **檔案無法播放**：嘗試使用不同的編碼器重新錄製，或使用我們提供的 `convert_video.py` 工具轉換現有檔案。
