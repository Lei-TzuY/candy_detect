# 舊資料集數量差異詳細分析

## 📊 數量統計

### 原始資料（未切分）
| 資料夾 | abnormal | normal | 總計 |
|--------|----------|--------|------|
| `abnormal/` | 35 張 | - | 35 張 |
| `normal/` | - | 527 張 | 527 張 |
| `train/` | 35 張 | 527 張 | **562 張** |

**結論**: `train/` 資料夾 = `abnormal/` + `normal/` 的合併（完整原始資料）

---

### 訓練資料（已切分）
| 資料夾 | abnormal | normal | 總計 |
|--------|----------|--------|------|
| `dataset/images/train/` | 29 張 | 421 張 | 450 張 |
| `dataset/images/val/` | 6 張 | 106 張 | 112 張 |
| **dataset 總計** | **35 張** | **527 張** | **562 張** |

**結論**: `dataset/` 使用了 `train/` 的全部 562 張，以 8:2 比例分割

---

## 🔍 差異解釋

### 1️⃣ Abnormal 差異：29 vs 35 張（差 6 張）

❌ **不是遺失！** 是分配到驗證集了

- `dataset/images/train/` - **29 張** abnormal
- `dataset/images/val/` - **6 張** abnormal
- **總計：35 張**（與原始 `abnormal/` 相同）

**被分配到 val/ 的 6 張 abnormal 檔案：**
```
abnormal1_jpg.rf.35ac7a146b4fec42df98e320a7166863
abnormal1_jpg.rf.76c753694f937ddd4818a7891c1d884a
abnormal1_jpg.rf.a7e55d5d85c2dadb4af2d83223131da1
abnormal2_jpg.rf.2499de4064ffc7ae3f3aee3e70bfd35b
abnormal5_jpg.rf.abdbff3e26d48680b34ae245d9105228
abnormal5_jpg.rf.c79533737209619f883df2556aa036aa
```

---

### 2️⃣ Normal 差異：421 vs 527 張（差 106 張）

❌ **不是遺失！** 也是分配到驗證集了

- `dataset/images/train/` - **421 張** normal
- `dataset/images/val/` - **106 張** normal
- **總計：527 張**（與原始 `normal/` 相同）

---

## 📐 訓練/驗證集分割比例

### 整體分割（8:2）
- **訓練集**：450 張（80%）
- **驗證集**：112 張（20%）
- ✅ 符合標準 80/20 分割比例

### Abnormal 類別分割
- **訓練集**：29 張（82.9%）
- **驗證集**：6 張（17.1%）
- ⚠️ 略微不平衡（理想應該是 28 train / 7 val）

### Normal 類別分割
- **訓練集**：421 張（79.9%）
- **驗證集**：106 張（20.1%）
- ✅ 非常接近 80/20

---

## ⚠️ 類別不平衡問題

### 嚴重不平衡！

| 類別 | 數量 | 百分比 |
|------|------|--------|
| Normal（正常） | 527 張 | **93.8%** |
| Abnormal（瑕疵） | 35 張 | **6.2%** |

### 影響：
1. **模型偏向預測 Normal** - 有 93.8% 的機率看到正常樣本
2. **Abnormal 學習不足** - 只有 35 個樣本太少
3. **驗證集 Abnormal 只有 6 張** - 驗證不可靠
4. **訓練集 Abnormal 只有 29 張** - 難以學習特徵

### 建議：
1. **增加瑕疵樣本** - 至少需要 100+ 張
2. **數據增強** - 對 abnormal 進行旋轉、翻轉、縮放
3. **使用 class weights** - 訓練時給 abnormal 更高權重
4. **考慮過採樣** - 重複使用 abnormal 樣本

---

## 🎯 總結

### ✅ 沒有檔案遺失
- 所有 562 張圖片都在 `dataset/` 中
- 只是被分配到 train/ 和 val/ 兩個資料夾

### ⚠️ 主要問題
1. **類別極度不平衡**：93.8% normal vs 6.2% abnormal
2. **Abnormal 樣本太少**：只有 35 張（其中訓練集只有 29 張）
3. **驗證集 Abnormal 只有 6 張**：難以評估模型對瑕疵的檢測能力

### 💡 建議行動
1. **收集更多瑕疵圖片** - 這是最重要的
2. **使用數據增強** - 擴充現有 35 張 abnormal
3. **調整訓練參數** - 使用 class weights 平衡
4. **考慮重新分配 val 集** - 確保 abnormal 有足夠驗證樣本

---

## 📂 資料夾關係圖

```
之前訓練的 yolov8/
│
├── abnormal/          (35 張 abnormal，原始來源)
├── normal/            (527 張 normal，原始來源)
├── train/             (562 張混合，= abnormal + normal)
│
└── dataset/           (訓練用數據集)
    ├── images/
    │   ├── train/     (450 張：29 abnormal + 421 normal)
    │   └── val/       (112 張：6 abnormal + 106 normal)
    └── labels/
        ├── train/     (450 個標註檔)
        └── val/       (112 個標註檔)
```

**結論**：沒有檔案遺失，只是 `voc2yolo_split.py` 自動進行了 80/20 分割！
